<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lesson 7 Fallacies, Correlation and Regression | Introduction to Data Analysis with R</title>
<meta name="author" content="Jannik Buhr">
<meta name="description" content="… in which we hear Stories of Warplanes, Correlation and Regression and explore the Datasaurus Dozen.  These are just the notes for the lecture that will be filled during the recording. Check back...">
<meta name="generator" content="bookdown 0.24.2 with bs4_book()">
<meta property="og:title" content="Lesson 7 Fallacies, Correlation and Regression | Introduction to Data Analysis with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://jmbuhr.de/dataintro/fallacies-correlation-and-regression.html">
<meta property="og:description" content="… in which we hear Stories of Warplanes, Correlation and Regression and explore the Datasaurus Dozen.  These are just the notes for the lecture that will be filled during the recording. Check back...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lesson 7 Fallacies, Correlation and Regression | Introduction to Data Analysis with R">
<meta name="twitter:description" content="… in which we hear Stories of Warplanes, Correlation and Regression and explore the Datasaurus Dozen.  These are just the notes for the lecture that will be filled during the recording. Check back...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><script src="libs/twitter-widget-0.0.1/widgets.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Data Analysis with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Hello and welcome!</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">2</span> Data Wrangling</a></li>
<li><a class="" href="tidy-data.html"><span class="header-section-number">3</span> Tidy data</a></li>
<li><a class="" href="functional-programming.html"><span class="header-section-number">4</span> Functional Programming</a></li>
<li><a class="" href="probability-and-hypothesis-testing.html"><span class="header-section-number">5</span> Probability and Hypothesis Testing</a></li>
<li><a class="" href="distributions-summaries-and-dimensionality-reduction.html"><span class="header-section-number">6</span> Distributions, Summaries and Dimensionality Reduction</a></li>
<li><a class="active" href="fallacies-correlation-and-regression.html"><span class="header-section-number">7</span> Fallacies, Correlation and Regression</a></li>
<li><a class="" href="freestyle.html"><span class="header-section-number">8</span> Freestyle</a></li>
<li><a class="" href="resources-5.html">Resources</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jmbuhr/dataintro">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="fallacies-correlation-and-regression" class="section level1" number="7">
<h1>
<span class="header-section-number">Lesson 7</span> Fallacies, Correlation and Regression<a class="anchor" aria-label="anchor" href="#fallacies-correlation-and-regression"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p>… in which we hear Stories of Warplanes,
Correlation and Regression and explore the Datasaurus Dozen.</p>
</blockquote>
<div class="alert alert-info">
<p>These are just the notes for the lecture that
will be filled during the recording.
Check back later to the the completed script.</p>
</div>
<!-- ::: {.video-container} -->
<!-- <iframe class="video" src="https://www.youtube.com/embed/VYLAxbt9Izk?vq=hd1080" allowfullscreen></iframe> -->
<!-- ::: -->
<div id="setup" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Setup<a class="anchor" aria-label="anchor" href="#setup"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue">glue</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="data-considerations" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Data Considerations<a class="anchor" aria-label="anchor" href="#data-considerations"><i class="fas fa-link"></i></a>
</h2>
<div id="section" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> 1943<a class="anchor" aria-label="anchor" href="#section"><i class="fas fa-link"></i></a>
</h3>
<p>It is 1943. The second World War is well underway, ravaging large parts of Europe.
Military aircraft that had first entered the stage in World War I are now
reaching their peak importance as they rain fire from the skies. But the Allied
forces are facing a problem. As warplanes get better, so do anti-aircraft
systems. In an effort to improve the survival of their fleet, the US military
starts examining the planes returning from skirmishes with the opposing forces.
They characterize the pattern of bullet holes in the metal hull, meticulously
noting down each hit that the plane sustained. The resulting picture is better
summarized in the modern, redrawn version below.</p>
<div class="figure">
<img src="images/survivorship-bias.png" alt=""><p class="caption">Figure from Wikipedia.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;span&gt;“Survivorship Bias,”&lt;/span&gt; &lt;em&gt;Wikipedia&lt;/em&gt;, December 2020.&lt;/p&gt;"><sup>23</sup></a></span></p>
</div>
<p>After taking a look at the data they gathered, the military is ready to rush
into action. To improve the endurance of their aircraft, the plan is to
reinforce the parts of the plane that were most often hit by bullets. With
stronger wings and a sturdier body of the plane, they think, surely more pilots
will come back from their missions safely. They were wrong.</p>
<p>But the pilots where in luck. The military also consulted with the Statistics
Research Group at Columbia University. A man named Abraham Wald worked there. In
his now unclassified report “A method of estimating plane vulnerability based on
damage of survivors”, he argued against the generals’ conclusion.<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Abraham Wald, &lt;span&gt;“A &lt;span&gt;Reprint&lt;/span&gt; of ’&lt;span&gt;A Method&lt;/span&gt; of &lt;span&gt;Estimating Plane Vulnerability Based&lt;/span&gt; on &lt;span&gt;Damage&lt;/span&gt; of &lt;span&gt;Survivors&lt;/span&gt;.”&lt;/span&gt; (&lt;span&gt;CENTER FOR NAVAL ANALYSES ALEXANDRIA VA OPERATIONS EVALUATION GROUP&lt;/span&gt;, July 1980).&lt;/p&gt;"><sup>24</sup></a></span> Instead of the most-hit parts of the planes,
the least-hit parts are to be reinforced.</p>
<div class="figure">
<img src="images/paste-57122EF0.png" alt=""><p class="caption">Cover of “A method of estimating plane vulnerability based on damage of survivors” <span class="citation">Wald<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;span&gt;“A &lt;span&gt;Reprint&lt;/span&gt; of ’&lt;span&gt;A Method&lt;/span&gt; of &lt;span&gt;Estimating Plane Vulnerability Based&lt;/span&gt; on &lt;span&gt;Damage&lt;/span&gt; of &lt;span&gt;Survivors&lt;/span&gt;.”&lt;/span&gt;&lt;/p&gt;"><sup>25</sup></a></span></p>
</div>
<blockquote>
<p>Instead of the most-hit parts, the least-hit parts are to be reinforced.</p>
</blockquote>
<p>The reason for this seemingly counterintuitive result is what is now known as
<em>survivorship bias</em>. The data that was collected contained only survivors, those
planes that sustained damage not severe enough to hinder them from coming back
after their mission. The aircraft that where hit in other places simply didn’t
make it back. Consequently, Wald advised to reinforce the engines and the fuel
tanks.</p>
</div>
<div id="thinking-further" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Thinking further<a class="anchor" aria-label="anchor" href="#thinking-further"><i class="fas fa-link"></i></a>
</h3>
<p>This is but one of a multitude of biases, specifically a selection bias, that
will influence the quality of the inferences you can draw from available data.
Keep in mind, data is not objective and never exists in a vacuum. There is
always context to consider. The way the data was collected is just one of them.
A lot of these ideas seem obvious in hindsight, which incidentally is another
bias that social psychologists call <em>hindsight bias</em>, but they can sometimes be
hard to spot.</p>
<p>A common saying is that music was better back in the days, or that all the old
music still holds up while the new stuff on the radio just sounds the same.
Well, not quite. This is also survivorship bias at work. All the bad and
forgettable songs from the past just faded into oblivion, never to be mentioned
again, while the songs people generally agreed to be good survived the ravages
of time unscathed.
A similar thing happens with success in general, not just songs.
If you ask any CEO high up the corporate ladder, a millionaire, or the author of a
book that reads “How to get rich”, they are sure to have a witty anecdote about
how their persistence, or their brilliance, or charisma got them to where they are
now. What we are not seeing is all the people just as witty, just as charismatic
or even just as persistent that where simply not as lucky. Very few people will
tell you this. Because it takes a whole lot of courage to admit that ones
success is based on luck and privilege.</p>
<p>And to take it back to the scientific context: When you are planning an
experiment for the lab, always ask whether your data collection process can in
some way be biased towards what you are trying to show.</p>
<p>I leave you with this:</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light">
<p lang="en" dir="ltr">weird how every time you see this image on twitter it has a ton of retweets <a href="https://t.co/VALAKdeheP">pic.twitter.com/VALAKdeheP</a></p>— Jake VanderPlas (@jakevdp) <a href="https://twitter.com/jakevdp/status/1336343740235935744?ref_src=twsrc%5Etfw">December 8, 2020</a>
</blockquote>

<p>And from this cautionary tale we jump straight back into RStudio.</p>
</div>
</div>
<div id="sidenotes" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Sidenotes<a class="anchor" aria-label="anchor" href="#sidenotes"><i class="fas fa-link"></i></a>
</h2>
<div id="glue" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> Glue<a class="anchor" aria-label="anchor" href="#glue"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="best-practices" class="section level3" number="7.3.2">
<h3>
<span class="header-section-number">7.3.2</span> Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"><i class="fas fa-link"></i></a>
</h3>
<blockquote>
<p><strong>Your raw data is sacred!</strong> Do not ever modify it or
save over it.</p>
</blockquote>
<ul>
<li>Don’t touch the <em>save</em> button in excel when looking at your raw data!</li>
<li>SEPT2</li>
<li>raw + derived</li>
</ul>
</div>
</div>
<div id="covariance-correlation-and-regression" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Covariance, Correlation and Regression<a class="anchor" aria-label="anchor" href="#covariance-correlation-and-regression"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<img src="images/correlation.png" alt=""><p class="caption">Source: <a href="https://xkcd.com/552/" class="uri">https://xkcd.com/552/</a></p>
</div>
<p><span class="math display">\[var(X) = \frac{\sum_{i=0}^{n}{(x_i-\bar x)^2}}{(n-1)}\]</span></p>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">50</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">m_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
<span class="va">m_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">m_x</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">"midnightblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">m_y</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">"midnightblue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="07-fallacies_files/figure-html/unnamed-chunk-3-1.png" width="100%"></div>
<p>We now get the <strong>covariance</strong> of X and Y as:</p>
<p><span class="math display">\[cov(X,Y)=\text{E}\left[(X-\text{E}\left[X\right])(Y-\text{E}\left[Y\right])\right]\]</span></p>
<p>So what we do is standardize it by dividing by both standard
deviations and get the <strong>correlation coefficient</strong>:</p>
<p><span class="math display">\[corr(X,Y)=\frac{cov(X,Y)}{\sigma_{X}\sigma_{Y}}\]</span></p>
<p>It’s full name is <em>Pearson product-moment correlation coefficient</em>,
or <em>pearsons R</em>. We can square it to get <span class="math inline">\(R^2\)</span>.</p>
<div id="introducing-the-dataset" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> Introducing the Dataset<a class="anchor" aria-label="anchor" href="#introducing-the-dataset"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="pearson-vs.-spearman-not-a-boxing-match" class="section level3" number="7.4.2">
<h3>
<span class="header-section-number">7.4.2</span> Pearson vs. Spearman (not a Boxing Match)<a class="anchor" aria-label="anchor" href="#pearson-vs.-spearman-not-a-boxing-match"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="linear-regression" class="section level3" number="7.4.3">
<h3>
<span class="header-section-number">7.4.3</span> Linear Regression<a class="anchor" aria-label="anchor" href="#linear-regression"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="non-linear-least-squares" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Non-linear Least Squares<a class="anchor" aria-label="anchor" href="#non-linear-least-squares"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="exercises-6" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-6"><i class="fas fa-link"></i></a>
</h2>
<div id="the-datasaurus-dozen" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> The Datasaurus Dozen<a class="anchor" aria-label="anchor" href="#the-datasaurus-dozen"><i class="fas fa-link"></i></a>
</h3>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="distributions-summaries-and-dimensionality-reduction.html"><span class="header-section-number">6</span> Distributions, Summaries and Dimensionality Reduction</a></div>
<div class="next"><a href="freestyle.html"><span class="header-section-number">8</span> Freestyle</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#fallacies-correlation-and-regression"><span class="header-section-number">7</span> Fallacies, Correlation and Regression</a></li>
<li><a class="nav-link" href="#setup"><span class="header-section-number">7.1</span> Setup</a></li>
<li>
<a class="nav-link" href="#data-considerations"><span class="header-section-number">7.2</span> Data Considerations</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#section"><span class="header-section-number">7.2.1</span> 1943</a></li>
<li><a class="nav-link" href="#thinking-further"><span class="header-section-number">7.2.2</span> Thinking further</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sidenotes"><span class="header-section-number">7.3</span> Sidenotes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#glue"><span class="header-section-number">7.3.1</span> Glue</a></li>
<li><a class="nav-link" href="#best-practices"><span class="header-section-number">7.3.2</span> Best Practices</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#covariance-correlation-and-regression"><span class="header-section-number">7.4</span> Covariance, Correlation and Regression</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introducing-the-dataset"><span class="header-section-number">7.4.1</span> Introducing the Dataset</a></li>
<li><a class="nav-link" href="#pearson-vs.-spearman-not-a-boxing-match"><span class="header-section-number">7.4.2</span> Pearson vs. Spearman (not a Boxing Match)</a></li>
<li><a class="nav-link" href="#linear-regression"><span class="header-section-number">7.4.3</span> Linear Regression</a></li>
</ul>
</li>
<li><a class="nav-link" href="#non-linear-least-squares"><span class="header-section-number">7.5</span> Non-linear Least Squares</a></li>
<li>
<a class="nav-link" href="#exercises-6"><span class="header-section-number">7.6</span> Exercises</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#the-datasaurus-dozen"><span class="header-section-number">7.6.1</span> The Datasaurus Dozen</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jmbuhr/dataintro/blob/main/07-fallacies.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jmbuhr/dataintro/edit/main/07-fallacies.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Data Analysis with R</strong>" was written by Jannik Buhr. It was last built on 2021-11-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
