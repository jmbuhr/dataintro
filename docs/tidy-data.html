<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lesson 3 Tidy Data | Introduction to Data Analysis with R</title>
<meta name="author" content="Jannik Buhr">
<meta name="description" content="… in which we explore the concept of Tidy Data, learn more advanced data wrangling techniques and get a sneak peak at iteration.">
<meta name="generator" content="bookdown 0.23.1 with bs4_book()">
<meta property="og:title" content="Lesson 3 Tidy Data | Introduction to Data Analysis with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://jmbuhr.de/dataintro/tidy-data.html">
<meta property="og:description" content="… in which we explore the concept of Tidy Data, learn more advanced data wrangling techniques and get a sneak peak at iteration.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lesson 3 Tidy Data | Introduction to Data Analysis with R">
<meta name="twitter:description" content="… in which we explore the concept of Tidy Data, learn more advanced data wrangling techniques and get a sneak peak at iteration.">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><script src="libs/twitter-widget-0.0.1/widgets.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Data Analysis with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Hello and welcome!</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">2</span> Data Wrangling</a></li>
<li><a class="active" href="tidy-data.html"><span class="header-section-number">3</span> Tidy Data</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">4</span> Functions</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">5</span> Hypothesis Testing</a></li>
<li><a class="" href="distributions.html"><span class="header-section-number">6</span> Distributions</a></li>
<li><a class="" href="fallacies.html"><span class="header-section-number">7</span> Fallacies</a></li>
<li><a class="" href="freestyle.html"><span class="header-section-number">8</span> Freestyle</a></li>
<li><a class="" href="resources.html">Resources</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jmbuhr/dataintro">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="tidy-data" class="section level1" number="3">
<h1>
<span class="header-section-number">Lesson 3</span> Tidy Data<a class="anchor" aria-label="anchor" href="#tidy-data"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p>… in which we explore the concept of Tidy Data, learn more
advanced data wrangling techniques and get a sneak peak at
iteration.</p>
</blockquote>
<!--

::: {.video-container}
<iframe class="video" src="https://www.youtube.com/embed/V3AFBd5GbLw" allowfullscreen></iframe>
:::


## Tidy data

### What and Why is Tidy Data?

There is one concept which also lends it's name to
the tidyverse that I want to talk about.
**Tidy Data** is a way of turning your datasets into a uniform shape.
This makes it easier to develop and work with tools because we get a consistent interface.
Once you know how to turn any dataset into a tidy dataset,
you are on home turf and can express your ideas more fluently in code.
Getting there can sometimes be tricky,
but I will give you the most important tools.
Because...

> »Tidy datasets are all alike,<br> but every messy dataset is messy in its own way.«<br> --- Hadley Wickham

freely adapted from:

> »Happy families are all alike;<br> every unhappy family is unhappy in its own way.«<br> --- Leo Tolstoy

So, how can we recognize tidy data?

(ref:tidy) Figure from <https://r4ds.had.co.nz/tidy-data.html> [@wickhamDataScienceImport2017]

<div class="figure">
<img src="images/tidy-data-wickham.png" alt="(ref:tidy)" width="100%" class=external />
<p class="caption">(\#fig:tidy-definition)(ref:tidy)</p>
</div>

In tidy data, each variable (feature) forms it's own column.
Each observation forms a row.
And each cell is a single value (measurement).
Furthermore, information about the same things belongs in one table.

The `tidyr` package contained in the tidyverse provides small example datasets to demonstrate what this means in practice. Hadley Wickham and Garrett Grolemund use these in their book as well (<https://r4ds.had.co.nz/tidy-data.html>)[@wickhamDataScienceImport2017].

`table1`, `table2`, `table3`, `table4a`, `table4b`,
and `table5` all display the number of TB cases documented by
the World Health Organization in Afghanistan, Brazil,
and China between 1999 and 2000.
The first of these is in the tidy format, the others are not:


```r
library(tidyverse)

# The paged_table function from the rmarkdown package prints the tables
# for the rmarkdown html document format so that it looks nice in the script.
# Alternatively you could use
# knitr's kable function
paged_table(table1)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["cases"],"name":[3],"type":["int"],"align":["right"]},{"label":["population"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"1999","3":"745","4":"19987071"},{"1":"Afghanistan","2":"2000","3":"2666","4":"20595360"},{"1":"Brazil","2":"1999","3":"37737","4":"172006362"},{"1":"Brazil","2":"2000","3":"80488","4":"174504898"},{"1":"China","2":"1999","3":"212258","4":"1272915272"},{"1":"China","2":"2000","3":"213766","4":"1280428583"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

This nicely qualifies as tidy data.
Every row is uniquely identified by the country and year,
and all other columns are properties of the specific country
in this specific year.


```r
paged_table(table2)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["count"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"1999","3":"cases","4":"745"},{"1":"Afghanistan","2":"1999","3":"population","4":"19987071"},{"1":"Afghanistan","2":"2000","3":"cases","4":"2666"},{"1":"Afghanistan","2":"2000","3":"population","4":"20595360"},{"1":"Brazil","2":"1999","3":"cases","4":"37737"},{"1":"Brazil","2":"1999","3":"population","4":"172006362"},{"1":"Brazil","2":"2000","3":"cases","4":"80488"},{"1":"Brazil","2":"2000","3":"population","4":"174504898"},{"1":"China","2":"1999","3":"cases","4":"212258"},{"1":"China","2":"1999","3":"population","4":"1272915272"},{"1":"China","2":"2000","3":"cases","4":"213766"},{"1":"China","2":"2000","3":"population","4":"1280428583"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

Now it gets interesting. `table2` still looks organized,
but it is not tidy (by our definition).
Note, this doesn't say the format is useless --- it has it's places ---
but it will not fit in as snugly with our tools. 
The column `type` is not a feature of the `country`,
rather the actual features are hidden in that column with
their values in the `count` column.
In order to make it tidy, this dataset would need to get wider.


```r
paged_table(table3)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["rate"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Afghanistan","2":"1999","3":"745/19987071","_rn_":"1"},{"1":"Afghanistan","2":"2000","3":"2666/20595360","_rn_":"2"},{"1":"Brazil","2":"1999","3":"37737/172006362","_rn_":"3"},{"1":"Brazil","2":"2000","3":"80488/174504898","_rn_":"4"},{"1":"China","2":"1999","3":"212258/1272915272","_rn_":"5"},{"1":"China","2":"2000","3":"213766/1280428583","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

In `table3`, two features are jammed into one column.
This is annoying, because we can't easily calculate
with the values; they are stored as text and
separated by a slash like `cases/population`.
Ideally, we would want to separate this column into two.


```r
paged_table(table4a)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["1999"],"name":[2],"type":["int"],"align":["right"]},{"label":["2000"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"745","3":"2666","_rn_":"1"},{"1":"Brazil","2":"37737","3":"80488","_rn_":"2"},{"1":"China","2":"212258","3":"213766","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>


```r
paged_table(table4b)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["1999"],"name":[2],"type":["int"],"align":["right"]},{"label":["2000"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"19987071","3":"20595360","_rn_":"1"},{"1":"Brazil","2":"172006362","3":"174504898","_rn_":"2"},{"1":"China","2":"1272915272","3":"1280428583","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

`table4a` and `table4b` split the data into two different tables,
which again makes it harder to calculate with.
This data is so closely related, we would want it in one table.
And another principle of tidy data is violated.
Notice the column names?
`1999` is not a feature that Afghanistan can have.
Rather, it is the value for a feature (namely the `year`),
while the values in the `1999` column are in fact 
values for the feature `population` (in `table4a`)
and `cases` (in `table4b`).


```r
paged_table(table5)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["century"],"name":[2],"type":["chr"],"align":["left"]},{"label":["year"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rate"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Afghanistan","2":"19","3":"99","4":"745/19987071","_rn_":"1"},{"1":"Afghanistan","2":"20","3":"00","4":"2666/20595360","_rn_":"2"},{"1":"Brazil","2":"19","3":"99","4":"37737/172006362","_rn_":"3"},{"1":"Brazil","2":"20","3":"00","4":"80488/174504898","_rn_":"4"},{"1":"China","2":"19","3":"99","4":"212258/1272915272","_rn_":"5"},{"1":"China","2":"20","3":"00","4":"213766/1280428583","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

In `table5`, we have the same problem as in `table3` and 
additionally the opposite problem!
This time, feature that should be one column (namely `year`)
is spread across two columns (`century` and `year`).
What we want to do is unite those into one.

### Making Data Tidy

<aside>
<a href="https://tidyr.tidyverse.org/">

<img src="images/tidyr.png" width="100%" class=external />

</a>
</aside>

with the `tidyr` package.

> **Note**: I do not go over data is better in another format in this course.
  Examples for this might involve matrices to benefit from matrix math or
  their multidimensional equivalent: arrays.

Let's make some data tidy!

### `pivot_wider`

Starting with table2, which wants to be wider.
Accordingly, we use the function `pivot_wider`.
It is very powerful, but the two most
important arguments (well, after the data) are
which column contains the names of the new columns
and which column contains the values of 
the newly created columns as shown below.


```r
table2 %>% 
  pivot_wider(names_from = type, values_from = count)
```

```
## # A tibble: 6 × 4
##   country      year  cases population
##   <chr>       <int>  <int>      <int>
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583
```

### `separate`

To make table3 tidy, we need the `separate` function,
followed by mutate to get the new columns into
the correct datatype.
Run it yourself step by step to see why the mutate
afterwards is necessary.


```r
table3 %>% 
  separate(rate, into = c("cases", "population"), sep = "/") %>% 
  mutate(cases = parse_number(cases),
         population = parse_number(population))
```

```
## # A tibble: 6 × 4
##   country      year  cases population
##   <chr>       <int>  <dbl>      <dbl>
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583
```

The `parse_` functions come from `readr`.
Parsing is the act of turning raw text into usable data,
and the `parse_number` function does a particularly good
job at extracting numbers, where the naïve approach of
`as.numeric` might fail e.g.


```r
some_text = "take my number: 12"
as.numeric(some_text)
```

```
## [1] NA
```


```r
parse_number(some_text)
```

```
## [1] 12
```

### `left_join` 

Now is the time to join `table4a` and `tabl4b` together.
For this, we need an operation known from databases
as a `join`.
In fact, this whole concept of 
tidy data is closely related to databases and
something called Codd`s normal forms [@coddRelationalModelDatabase1990; @wickhamTidyData2014] so I am throwing these
references in here just in case you are interested in
the theoretical foundations.
But without further ado:


```r
# the suffix argument is necessary because the columns
# in the two tables have the same names
table4 <- left_join(table4a, table4b, by = "country",
                    suffix = c("_cases", "_population"))
table4
```

```
## # A tibble: 3 × 5
##   country     `1999_cases` `2000_cases` `1999_population` `2000_population`
##   <chr>              <int>        <int>             <int>             <int>
## 1 Afghanistan          745         2666          19987071          20595360
## 2 Brazil             37737        80488         172006362         174504898
## 3 China             212258       213766        1272915272        1280428583
```

### `pivot_longer`

Now we can deal with the next problem:
Making the table longer so that
year, population and cases become their own
columns again, because they are independent features.
Consequently, we use the function `pivot_longer`:


```r
# note that cols takes what is called a tidyselect specification.
# you know this from the selection function and it's help page.
# here, I am selecting everything BUT the country column.
long_table4 <- table4 %>% 
  pivot_longer(cols = -country)
long_table4
```

```
## # A tibble: 12 × 3
##    country     name                 value
##    <chr>       <chr>                <int>
##  1 Afghanistan 1999_cases             745
##  2 Afghanistan 2000_cases            2666
##  3 Afghanistan 1999_population   19987071
##  4 Afghanistan 2000_population   20595360
##  5 Brazil      1999_cases           37737
##  6 Brazil      2000_cases           80488
##  7 Brazil      1999_population  172006362
##  8 Brazil      2000_population  174504898
##  9 China       1999_cases          212258
## 10 China       2000_cases          213766
## 11 China       1999_population 1272915272
## 12 China       2000_population 1280428583
```

But we are not done yet, table4 is putting all our skills
to the test.
There is a way to do the following steps with
`pivot_wider` straight away, but doing it step by
step should be easier to follow.
You can revisit this part and check out the
other arguments to `pivot_wider` if you fancy a challenge.
The next step we already know: separating 
a column into two.
Only the separator changed.


```r
long_table4_separated <- long_table4 %>% 
  separate(col = name, into = c("year", "type"), sep = "_")
long_table4_separated
```

```
## # A tibble: 12 × 4
##    country     year  type            value
##    <chr>       <chr> <chr>           <int>
##  1 Afghanistan 1999  cases             745
##  2 Afghanistan 2000  cases            2666
##  3 Afghanistan 1999  population   19987071
##  4 Afghanistan 2000  population   20595360
##  5 Brazil      1999  cases           37737
##  6 Brazil      2000  cases           80488
##  7 Brazil      1999  population  172006362
##  8 Brazil      2000  population  174504898
##  9 China       1999  cases          212258
## 10 China       2000  cases          213766
## 11 China       1999  population 1272915272
## 12 China       2000  population 1280428583
```

Now we are back to the problem we had in table2,
so we know how to make this table wider again:


```r
long_table4_separated %>% 
  pivot_wider(names_from = type, values_from = value)
```

```
## # A tibble: 6 × 4
##   country     year   cases population
##   <chr>       <chr>  <int>      <int>
## 1 Afghanistan 1999     745   19987071
## 2 Afghanistan 2000    2666   20595360
## 3 Brazil      1999   37737  172006362
## 4 Brazil      2000   80488  174504898
## 5 China       1999  212258 1272915272
## 6 China       2000  213766 1280428583
```

We did it!
Now one last look at `table5`, which contains a case
we haven't encountered yet: a feature is separated
across two columns, so we need the opposite of
`separeate`: `unite`.

### `unite`


```r
table5 %>% 
  unite(col = year, c(century, year), sep = "") %>% 
  mutate(year = parse_number(year))
```

```
## # A tibble: 6 × 3
##   country      year rate             
##   <chr>       <dbl> <chr>            
## 1 Afghanistan  1999 745/19987071     
## 2 Afghanistan  2000 2666/20595360    
## 3 Brazil       1999 37737/172006362  
## 4 Brazil       2000 80488/174504898  
## 5 China        1999 212258/1272915272
## 6 China        2000 213766/1280428583
```

### Another Example

Let us look at one last example of data that needs tidying,
which is also provided by the `tidyr` package as an example:


```r
head(billboard) %>% paged_table()
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["artist"],"name":[1],"type":["chr"],"align":["left"]},{"label":["track"],"name":[2],"type":["chr"],"align":["left"]},{"label":["date.entered"],"name":[3],"type":["date"],"align":["right"]},{"label":["wk1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["wk2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["wk3"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wk4"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["wk5"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["wk6"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["wk7"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["wk8"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["wk9"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["wk10"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["wk11"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["wk12"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["wk13"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["wk14"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["wk15"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["wk16"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["wk17"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["wk18"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["wk19"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["wk20"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["wk21"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["wk22"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["wk23"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["wk24"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["wk25"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["wk26"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["wk27"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["wk28"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["wk29"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["wk30"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["wk31"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["wk32"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["wk33"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["wk34"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["wk35"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["wk36"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["wk37"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["wk38"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["wk39"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["wk40"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["wk41"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["wk42"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["wk43"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["wk44"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["wk45"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["wk46"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["wk47"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["wk48"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["wk49"],"name":[52],"type":["dbl"],"align":["right"]},{"label":["wk50"],"name":[53],"type":["dbl"],"align":["right"]},{"label":["wk51"],"name":[54],"type":["dbl"],"align":["right"]},{"label":["wk52"],"name":[55],"type":["dbl"],"align":["right"]},{"label":["wk53"],"name":[56],"type":["dbl"],"align":["right"]},{"label":["wk54"],"name":[57],"type":["dbl"],"align":["right"]},{"label":["wk55"],"name":[58],"type":["dbl"],"align":["right"]},{"label":["wk56"],"name":[59],"type":["dbl"],"align":["right"]},{"label":["wk57"],"name":[60],"type":["dbl"],"align":["right"]},{"label":["wk58"],"name":[61],"type":["dbl"],"align":["right"]},{"label":["wk59"],"name":[62],"type":["dbl"],"align":["right"]},{"label":["wk60"],"name":[63],"type":["dbl"],"align":["right"]},{"label":["wk61"],"name":[64],"type":["dbl"],"align":["right"]},{"label":["wk62"],"name":[65],"type":["dbl"],"align":["right"]},{"label":["wk63"],"name":[66],"type":["dbl"],"align":["right"]},{"label":["wk64"],"name":[67],"type":["dbl"],"align":["right"]},{"label":["wk65"],"name":[68],"type":["dbl"],"align":["right"]},{"label":["wk66"],"name":[69],"type":["lgl"],"align":["right"]},{"label":["wk67"],"name":[70],"type":["lgl"],"align":["right"]},{"label":["wk68"],"name":[71],"type":["lgl"],"align":["right"]},{"label":["wk69"],"name":[72],"type":["lgl"],"align":["right"]},{"label":["wk70"],"name":[73],"type":["lgl"],"align":["right"]},{"label":["wk71"],"name":[74],"type":["lgl"],"align":["right"]},{"label":["wk72"],"name":[75],"type":["lgl"],"align":["right"]},{"label":["wk73"],"name":[76],"type":["lgl"],"align":["right"]},{"label":["wk74"],"name":[77],"type":["lgl"],"align":["right"]},{"label":["wk75"],"name":[78],"type":["lgl"],"align":["right"]},{"label":["wk76"],"name":[79],"type":["lgl"],"align":["right"]}],"data":[{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"2000-02-26","4":"87","5":"82","6":"72","7":"77","8":"87","9":"94","10":"99","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA","16":"NA","17":"NA","18":"NA","19":"NA","20":"NA","21":"NA","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"2Ge+her","2":"The Hardest Part Of ...","3":"2000-09-02","4":"91","5":"87","6":"92","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA","16":"NA","17":"NA","18":"NA","19":"NA","20":"NA","21":"NA","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"3 Doors Down","2":"Kryptonite","3":"2000-04-08","4":"81","5":"70","6":"68","7":"67","8":"66","9":"57","10":"54","11":"53","12":"51","13":"51","14":"51","15":"51","16":"47","17":"44","18":"38","19":"28","20":"22","21":"18","22":"18","23":"14","24":"12","25":"7","26":"6","27":"6","28":"6","29":"5","30":"5","31":"4","32":"4","33":"4","34":"4","35":"3","36":"3","37":"3","38":"4","39":"5","40":"5","41":"9","42":"9","43":"15","44":"14","45":"13","46":"14","47":"16","48":"17","49":"21","50":"22","51":"24","52":"28","53":"33","54":"42","55":"42","56":"49","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"3 Doors Down","2":"Loser","3":"2000-10-21","4":"76","5":"76","6":"72","7":"69","8":"67","9":"65","10":"55","11":"59","12":"62","13":"61","14":"61","15":"59","16":"61","17":"66","18":"72","19":"76","20":"75","21":"67","22":"73","23":"70","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"504 Boyz","2":"Wobble Wobble","3":"2000-04-15","4":"57","5":"34","6":"25","7":"17","8":"17","9":"31","10":"36","11":"49","12":"53","13":"57","14":"64","15":"70","16":"75","17":"76","18":"78","19":"85","20":"92","21":"96","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"98^0","2":"Give Me Just One Nig...","3":"2000-08-19","4":"51","5":"39","6":"34","7":"26","8":"26","9":"19","10":"2","11":"2","12":"3","13":"6","14":"7","15":"22","16":"29","17":"36","18":"47","19":"67","20":"66","21":"84","22":"93","23":"94","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

This is a lot of columns!
For 76 weeks after a song entered the top 100 (I assume in the USA)
it's position is recorded.
It might be in this format because it made data entry easier,
or the previous person wanted to make plots in excel,
where this wide format is used to denote multiple traces.
In any event, for our style of visualizations with the grammar of
graphics, we want a column to represent a feature,
so this data needs to get longer:


```r
long_billboard <- billboard %>% 
  pivot_longer(starts_with("w"),
               names_to = "week",
               names_pattern = "wk(\\d+)",
               values_to = "placement",
               values_drop_na = TRUE) %>% 
  mutate(week = parse_integer(week),
         date = as.Date(date.entered) + 7 * (week - 1)) %>% 
  select(-date.entered)

long_billboard %>% 
  head() %>% 
  paged_table()
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["artist"],"name":[1],"type":["chr"],"align":["left"]},{"label":["track"],"name":[2],"type":["chr"],"align":["left"]},{"label":["week"],"name":[3],"type":["int"],"align":["right"]},{"label":["placement"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["date"],"name":[5],"type":["date"],"align":["right"]}],"data":[{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"1","4":"87","5":"2000-02-26"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"2","4":"82","5":"2000-03-04"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"3","4":"72","5":"2000-03-11"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"4","4":"77","5":"2000-03-18"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"5","4":"87","5":"2000-03-25"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"6","4":"94","5":"2000-04-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

> This time I am leaving the visualisation up to you.
  This is a greate opportunity to play around with ggplot!

This whole tidy data idea might seem like just another
way of moving numbers around.
But once you build the mental model for it,
it will truly transform the way you are able to think about data.
Both for data wrangling with dplyr, as shown last
week, and also for data visualization with ggplot,
a journey we began in the first week and that is
still well underway.

## More Shapes for Data

The `tidyr` package provides more tools for dealing
with data in various shapes.
We just discovered the first set of operations called _pivoting_
to get a feel for tidy data and to obtain
it from various formats.
But data is not always rectangular
like we can show it in a spreadsheet.
Sometimes data already comes in a nested
form, sometimes we create nested data because it serves
our purpose (see next week).
So, what do I mean by nested?

### Nested Data

Remember that `lists` can contain elements
of any type, even other lists?
Well, if have  have a list that contains
more lists, we call it nested. E.g.


```r
list(
  c(1, 2),
  list(
    42, list("hi", TRUE)
  )
)
```

```
## [[1]]
## [1] 1 2
## 
## [[2]]
## [[2]][[1]]
## [1] 42
## 
## [[2]][[2]]
## [[2]][[2]][[1]]
## [1] "hi"
## 
## [[2]][[2]][[2]]
## [1] TRUE
```
But nested list are not always fun to work with,
and when there is a straightforward way to represent
the same data in a rectangular, flat format,
we most likely want to do that.
We will deal with data rectangling today was well.
But first, there is another implication
of nested lists:
Because dataframes (and tibbles) are built on top
of lists, we can nest them to!
This can sometimes come in really handy.
We a dataframe contains a column that is not
an atomic vector but a list (so it is a list in a list),
we call it a list column:


```r
example <- tibble(
  x = 1:3,
  y = list("hello", TRUE, c(1,2,3,4))
)
example
```

```
## # A tibble: 3 × 2
##       x y        
##   <int> <list>   
## 1     1 <chr [1]>
## 2     2 <lgl [1]>
## 3     3 <dbl [4]>
```

Here, the output in our code only tells us,
that the list column y contains an
atomic character vector of length 1,
a logical vector of length 1 and
a double vector of length 4.
The overall length of the column is 3,
because it has to fit in the tibble.

We can get a better view of what is in there
by either pulling the column out with
the subsetting functions we already learned
(like `$`, `[[]]`, `pull`), using
`str` to learn more about the structure
or simply using RStudio's **Environment** panel
to inspect our variable.
Click on the name to view it in a new window
(the same can be done from code by using
the function `View` or Ctrl+Clicking the variable name)
or use the little blue arrow to expand the list.


```r
include_graphics("images/environment.png")
```

<img src="images/environment.png" width="100%" />

This extends even further,
we are about to go full inception on this!
A list column can contain tibbles (/dataframes)
as well!


```r
nested_tibble <- tibble(
  id = 1:2,
  df = list(
    tibble(x = 1:10, y = x^2),
    tibble(x = seq(1, 100, 3), y = sqrt(x))
  )
)

nested_tibble
```

```
## # A tibble: 2 × 2
##      id df               
##   <int> <list>           
## 1     1 <tibble [10 × 2]>
## 2     2 <tibble [34 × 2]>
```

We can still use the data nested in there,
as long as we remember how to chain
our subsetting functions together.


```r
# take the column df, take the second element
nested_tibble$df[[2]]
```

```
## # A tibble: 34 × 2
##        x     y
##    <dbl> <dbl>
##  1     1  1   
##  2     4  2   
##  3     7  2.65
##  4    10  3.16
##  5    13  3.61
##  6    16  4   
##  7    19  4.36
##  8    22  4.69
##  9    25  5   
## 10    28  5.29
## # … with 24 more rows
```

A handy way to subsett into nested structures
is with the `pluck` function:


```r
nested_tibble %>% pluck("df", 2)
```

```
## # A tibble: 34 × 2
##        x     y
##    <dbl> <dbl>
##  1     1  1   
##  2     4  2   
##  3     7  2.65
##  4    10  3.16
##  5    13  3.61
##  6    16  4   
##  7    19  4.36
##  8    22  4.69
##  9    25  5   
## 10    28  5.29
## # … with 24 more rows
```



```r
nested_tibble$df[[2]] %>% 
  ggplot(aes(x, y)) +
  geom_line() +
  geom_point() + 
  theme_minimal()
```

<img src="dataintro_files/figure-html/unnamed-chunk-80-1.png" width="100%" />

This will be incredibly useful next week,
when we talk about **iteration**.

Creating a tibble by hand is unlikely
going to be the way that you end up
with a nested tibble.
Let's create one from an already existing tibble.
We can use the long version of the
billboard dataset we created above.


```r
nested_billboard <- long_billboard %>% 
  nest(data = c(-artist, -track))

head(nested_billboard)
```

```
## # A tibble: 6 × 3
##   artist       track                   data             
##   <chr>        <chr>                   <list>           
## 1 2 Pac        Baby Don't Cry (Keep... <tibble [7 × 3]> 
## 2 2Ge+her      The Hardest Part Of ... <tibble [3 × 3]> 
## 3 3 Doors Down Kryptonite              <tibble [53 × 3]>
## 4 3 Doors Down Loser                   <tibble [20 × 3]>
## 5 504 Boyz     Wobble Wobble           <tibble [18 × 3]>
## 6 98^0         Give Me Just One Nig... <tibble [20 × 3]>
```

Notice, how similar this is to `group_by`,
except it is much more explicit.
The resulting groups are now separated
into their own tibble in the
list column I named _data_.
Again, RStudio's environment panel
makes it easier to inspect the data.

We can get back to our original shape
by **unnesting** the tibble


```r
nested_billboard %>% 
  unnest(data) %>% 
  head()
```

```
## # A tibble: 6 × 5
##   artist track                    week placement date      
##   <chr>  <chr>                   <int>     <dbl> <date>    
## 1 2 Pac  Baby Don't Cry (Keep...     1        87 2000-02-26
## 2 2 Pac  Baby Don't Cry (Keep...     2        82 2000-03-04
## 3 2 Pac  Baby Don't Cry (Keep...     3        72 2000-03-11
## 4 2 Pac  Baby Don't Cry (Keep...     4        77 2000-03-18
## 5 2 Pac  Baby Don't Cry (Keep...     5        87 2000-03-25
## 6 2 Pac  Baby Don't Cry (Keep...     6        94 2000-04-01
```

Unnesting is one special case for the
general idea of data rectangling, for
which the `tidyr` package provides more functions.
Unfortunately, we can't all explore them all today.

## A Sneak Peak at Iteration

Next week we are going to explore
the concept of iteration, having R do one
operation for multiple things.
But today, I am already giving you a
sneak peak at how nested data can help
us in that respect.
It will also make sure you get more
comfortable with writing functions.

Let us take just one dataset out of
the many datasets:


```r
one_track <- nested_billboard$data[[1]]
one_track
```

```
## # A tibble: 7 × 3
##    week placement date      
##   <int>     <dbl> <date>    
## 1     1        87 2000-02-26
## 2     2        82 2000-03-04
## 3     3        72 2000-03-11
## 4     4        77 2000-03-18
## 5     5        87 2000-03-25
## 6     6        94 2000-04-01
## 7     7        99 2000-04-08
```

This contains the performance of one song.
we can create a plot of it:


```r
ggplot(one_track, aes(week, placement)) +
  geom_line() +
  theme_linedraw()
```

<img src="dataintro_files/figure-html/unnamed-chunk-84-1.png" width="100%" />

Moreover, we can create a function,
that takes some data and creates
a plot from it:


```r
plot_song_performance <- function(song_data) {
  ggplot(song_data, aes(week, placement)) +
    geom_line() +
    theme_linedraw()
}
```

We can now pass any song data from the
nested dataframe to it:


```r
plot_song_performance(nested_billboard$data[[1]])
```

<img src="dataintro_files/figure-html/unnamed-chunk-86-1.png" width="100%" />

But we are more ambitious, we want this
plot for all songs!
The `map` function from the `purrr` package
takes a list and a function and 
applies the function to all elements of the
list. It is really powerful (and fun).
We will learn all about it next week,
but here is a preview:

<aside>
<a href="https://purrr.tidyverse.org/">
![](images/purrr.png)
</a>
</aside>



```r
song_performance <- nested_billboard %>% 
   mutate(
      plt = map(data, plot_song_performance)
   )

song_performance %>% head()
```

```
## # A tibble: 6 × 4
##   artist       track                   data              plt   
##   <chr>        <chr>                   <list>            <list>
## 1 2 Pac        Baby Don't Cry (Keep... <tibble [7 × 3]>  <gg>  
## 2 2Ge+her      The Hardest Part Of ... <tibble [3 × 3]>  <gg>  
## 3 3 Doors Down Kryptonite              <tibble [53 × 3]> <gg>  
## 4 3 Doors Down Loser                   <tibble [20 × 3]> <gg>  
## 5 504 Boyz     Wobble Wobble           <tibble [18 × 3]> <gg>  
## 6 98^0         Give Me Just One Nig... <tibble [20 × 3]> <gg>
```

And now we can look at individual plots:


```r
song_performance$plt[[24]]
```

<img src="dataintro_files/figure-html/unnamed-chunk-88-1.png" width="100%" />

It might have been handy to include a title
for the plot, so let's modify 
our plotting function a little bit:


```r
plot_song_performance <- function(song_data, title) {
  ggplot(song_data, aes(week, placement)) +
    geom_line() +
    theme_linedraw() +
    labs(title = title)
}
```

And now we use the function `map2` instead of `map`,
which iterates over two vectors at the
same time to also pass the plot title:


```r
song_performance <- nested_billboard %>% 
   mutate(
      plt = map2(data, track,  plot_song_performance)
   )

song_performance$plt[[1]]
```

<img src="dataintro_files/figure-html/unnamed-chunk-90-1.png" width="100%" />

When we don't care about the return value
of a function, but rather about the side-effect
it has, we use the `walk` function in place of `map`.
A side-effect is anything that changes the state
of your program or the world around it,
as opposed to pure functions, which only depend
on their arguments return some value.
Writing to a file for example is a side effect:


```r
dir.create("plts")

save_plot <- function(name, plot) {
  ggsave(paste0("plts/", name, ".png"), plot)
}

walk2(song_performance$track, song_performance$plt, save_plot)
```

Do try this at home, it feels quite good
to achieve so much with one key-press!

## Exercises

## Tidy Data

1. Imagine for a second this whole pandemic thing is not
  going on and we are planning a vacation.
  Of course, we want to choose the safest airline possible,
  so we download data about incident reports.
  You can find it in the _data_ folder^[source: [tidytuesday](https://github.com/rfordatascience/tidytuesday/tree/master/data/2018/2018-08-07)].
2. Instead of the `type_of_event` and `n_events` columns
  we would like to have one column per type of event,
  where the values are the count for this event.
3. Which airlines had the least fatal accidents,
  standardized to the distance theses airlines covered,
  in the two time ranges?
4. Even if something where to go wrong, which airlines
  have the best record when it comes to fatalities per fatal accident?
5. Create an informative plot to highlight your
  discoveries. It might be beneficial to only
  plot e.g. the highest or lowest scoring Airlines.
  One of the `slice_` functions will help you there.
  And to make your plot prettier, you will
  have to look into `fct_reorder` again.

## Functions and Iteration

1. You are going strong so far! Programming can sometimes
  to motivate us. R is up to the task.
  be frustrating, so I think what we need is someone
  Write a function that takes a name, like "Jannik" or
  your name, and spits out a motivational message that
  includes the name.
  Make sure to also test it and show that it works.
2. Now that you have a motivational machine,
  you need to make sure to motivate the greatest
  amount of people.
  Use the `map` function to apply your function
  to a whole vector of names.

## Resources

- [tidyr documentation](https://tidyr.tidyverse.org/)
- [purrr documentation](https://purrr.tidyverse.org/)
- [stringr documentation](https://stringr.tidyverse.org/)
  for working with text and a helpful cheatsheet for
  the **regular expressions** mentioned in the video

-->

</div>
  <div class="chapter-nav">
<div class="prev"><a href="data-wrangling.html"><span class="header-section-number">2</span> Data Wrangling</a></div>
<div class="next"><a href="functions.html"><span class="header-section-number">4</span> Functions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#tidy-data"><span class="header-section-number">3</span> Tidy Data</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jmbuhr/dataintro/blob/main/03-tidy.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jmbuhr/dataintro/edit/main/03-tidy.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Data Analysis with R</strong>" was written by Jannik Buhr. It was last built on 2021-08-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
