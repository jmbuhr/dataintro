<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lesson 3 Tidy Data | Introduction to Data Analysis with R</title>
<meta name="author" content="Jannik Buhr">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><script src="libs/twitter-widget-0.0.1/widgets.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Data Analysis with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Hello and welcome!</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">2</span> Data Wrangling</a></li>
<li><a class="active" href="tidy-data.html"><span class="header-section-number">3</span> Tidy Data</a></li>
<li><a class="" href="functions-1.html"><span class="header-section-number">4</span> Functions</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">5</span> Hypothesis Testing</a></li>
<li><a class="" href="distributions.html"><span class="header-section-number">6</span> Distributions</a></li>
<li><a class="" href="fallacies.html"><span class="header-section-number">7</span> Fallacies</a></li>
<li><a class="" href="freestyle.html"><span class="header-section-number">8</span> Freestyle</a></li>
<li><a class="" href="resources-5.html">Resources</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jmbuhr/dataintro">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="tidy-data" class="section level1" number="3">
<h1>
<span class="header-section-number">Lesson 3</span> Tidy Data<a class="anchor" aria-label="anchor" href="#tidy-data"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p>… in which we explore the concept of Tidy Data, learn more
advanced data wrangling techniques and get a sneak peak at
iteration.</p>
</blockquote>
<div class="video-container">
<iframe class="video" src="https://www.youtube.com/embed/V3AFBd5GbLw" allowfullscreen>
</iframe>
</div>
<div id="tidy-data-1" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Tidy data<a class="anchor" aria-label="anchor" href="#tidy-data-1"><i class="fas fa-link"></i></a>
</h2>
<div id="what-and-why-is-tidy-data" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> What and Why is Tidy Data?<a class="anchor" aria-label="anchor" href="#what-and-why-is-tidy-data"><i class="fas fa-link"></i></a>
</h3>
<p>There is one concept which also lends it’s name to
the tidyverse that I want to talk about.
<strong>Tidy Data</strong> is a way of turning your datasets into a uniform shape.
This makes it easier to develop and work with tools because we get a consistent interface.
Once you know how to turn any dataset into a tidy dataset,
you are on home turf and can express your ideas more fluently in code.
Getting there can sometimes be tricky,
but I will give you the most important tools.
Because…</p>
<blockquote>
<p>»Tidy datasets are all alike,<br> but every messy dataset is messy in its own way.«<br> — Hadley Wickham</p>
</blockquote>
<p>freely adapted from:</p>
<blockquote>
<p>»Happy families are all alike;<br> every unhappy family is unhappy in its own way.«<br> — Leo Tolstoy</p>
</blockquote>
<p>So, how can we recognize tidy data?</p>

<div class="figure">
<span id="fig:tidy-definition"></span>
<img src="images/tidy-data-wickham.png" alt="Figure from https://r4ds.had.co.nz/tidy-data.html26" width="100%" class="external"><p class="caption">
Figure 3.1: Figure from <a href="https://r4ds.had.co.nz/tidy-data.html" class="uri">https://r4ds.had.co.nz/tidy-data.html</a><span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Wickham and Grolemund, &lt;em&gt;R for &lt;span&gt;Data Science&lt;/span&gt;&lt;/em&gt;.&lt;/p&gt;"><sup>26</sup></a></span>
</p>
</div>
<p>In tidy data, each variable (feature) forms it’s own column.
Each observation forms a row.
And each cell is a single value (measurement).
Furthermore, information about the same things belongs in one table.</p>
<p>The <code>tidyr</code> package contained in the tidyverse provides small example datasets to demonstrate what this means in practice. Hadley Wickham and Garrett Grolemund use these in their book as well (<a href="https://r4ds.had.co.nz/tidy-data.html" class="uri">https://r4ds.had.co.nz/tidy-data.html</a>)<span class="citation">.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Wickham and Grolemund.&lt;/p&gt;"><sup>27</sup></a></span></p>
<p><code>table1</code>, <code>table2</code>, <code>table3</code>, <code>table4a</code>, <code>table4b</code>,
and <code>table5</code> all display the number of TB cases documented by
the World Health Organization in Afghanistan, Brazil,
and China between 1999 and 2000.
The first of these is in the tidy format, the others are not:</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="co"># The paged_table function from the rmarkdown package prints the tables</span>
<span class="co"># for the rmarkdown html document format so that it looks nice in the script.</span>
<span class="co"># Alternatively you could use</span>
<span class="co"># knitr's kable function</span>
<span class="fu">paged_table</span><span class="op">(</span><span class="va">table1</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["cases"],"name":[3],"type":["int"],"align":["right"]},{"label":["population"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"1999","3":"745","4":"19987071"},{"1":"Afghanistan","2":"2000","3":"2666","4":"20595360"},{"1":"Brazil","2":"1999","3":"37737","4":"172006362"},{"1":"Brazil","2":"2000","3":"80488","4":"174504898"},{"1":"China","2":"1999","3":"212258","4":"1272915272"},{"1":"China","2":"2000","3":"213766","4":"1280428583"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>This nicely qualifies as tidy data.
Every row is uniquely identified by the country and year,
and all other columns are properties of the specific country
in this specific year.</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">paged_table</span><span class="op">(</span><span class="va">table2</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["count"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"1999","3":"cases","4":"745"},{"1":"Afghanistan","2":"1999","3":"population","4":"19987071"},{"1":"Afghanistan","2":"2000","3":"cases","4":"2666"},{"1":"Afghanistan","2":"2000","3":"population","4":"20595360"},{"1":"Brazil","2":"1999","3":"cases","4":"37737"},{"1":"Brazil","2":"1999","3":"population","4":"172006362"},{"1":"Brazil","2":"2000","3":"cases","4":"80488"},{"1":"Brazil","2":"2000","3":"population","4":"174504898"},{"1":"China","2":"1999","3":"cases","4":"212258"},{"1":"China","2":"1999","3":"population","4":"1272915272"},{"1":"China","2":"2000","3":"cases","4":"213766"},{"1":"China","2":"2000","3":"population","4":"1280428583"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Now it gets interesting. <code>table2</code> still looks organized,
but it is not tidy (by our definition).
Note, this doesn’t say the format is useless — it has it’s places —
but it will not fit in as snugly with our tools.
The column <code>type</code> is not a feature of the <code>country</code>,
rather the actual features are hidden in that column with
their values in the <code>count</code> column.
In order to make it tidy, this dataset would need to get wider.</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">paged_table</span><span class="op">(</span><span class="va">table3</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["rate"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Afghanistan","2":"1999","3":"745/19987071","_rn_":"1"},{"1":"Afghanistan","2":"2000","3":"2666/20595360","_rn_":"2"},{"1":"Brazil","2":"1999","3":"37737/172006362","_rn_":"3"},{"1":"Brazil","2":"2000","3":"80488/174504898","_rn_":"4"},{"1":"China","2":"1999","3":"212258/1272915272","_rn_":"5"},{"1":"China","2":"2000","3":"213766/1280428583","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In <code>table3</code>, two features are jammed into one column.
This is annoying, because we can’t easily calculate
with the values; they are stored as text and
separated by a slash like <code>cases/population</code>.
Ideally, we would want to separate this column into two.</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">paged_table</span><span class="op">(</span><span class="va">table4a</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["1999"],"name":[2],"type":["int"],"align":["right"]},{"label":["2000"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"745","3":"2666","_rn_":"1"},{"1":"Brazil","2":"37737","3":"80488","_rn_":"2"},{"1":"China","2":"212258","3":"213766","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">paged_table</span><span class="op">(</span><span class="va">table4b</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["1999"],"name":[2],"type":["int"],"align":["right"]},{"label":["2000"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"19987071","3":"20595360","_rn_":"1"},{"1":"Brazil","2":"172006362","3":"174504898","_rn_":"2"},{"1":"China","2":"1272915272","3":"1280428583","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code>table4a</code> and <code>table4b</code> split the data into two different tables,
which again makes it harder to calculate with.
This data is so closely related, we would want it in one table.
And another principle of tidy data is violated.
Notice the column names?
<code>1999</code> is not a feature that Afghanistan can have.
Rather, it is the value for a feature (namely the <code>year</code>),
while the values in the <code>1999</code> column are in fact
values for the feature <code>population</code> (in <code>table4a</code>)
and <code>cases</code> (in <code>table4b</code>).</p>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">paged_table</span><span class="op">(</span><span class="va">table5</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["century"],"name":[2],"type":["chr"],"align":["left"]},{"label":["year"],"name":[3],"type":["chr"],"align":["left"]},{"label":["rate"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Afghanistan","2":"19","3":"99","4":"745/19987071","_rn_":"1"},{"1":"Afghanistan","2":"20","3":"00","4":"2666/20595360","_rn_":"2"},{"1":"Brazil","2":"19","3":"99","4":"37737/172006362","_rn_":"3"},{"1":"Brazil","2":"20","3":"00","4":"80488/174504898","_rn_":"4"},{"1":"China","2":"19","3":"99","4":"212258/1272915272","_rn_":"5"},{"1":"China","2":"20","3":"00","4":"213766/1280428583","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In <code>table5</code>, we have the same problem as in <code>table3</code> and
additionally the opposite problem!
This time, feature that should be one column (namely <code>year</code>)
is spread across two columns (<code>century</code> and <code>year</code>).
What we want to do is unite those into one.</p>
</div>
<div id="making-data-tidy" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Making Data Tidy<a class="anchor" aria-label="anchor" href="#making-data-tidy"><i class="fas fa-link"></i></a>
</h3>
<aside><p><a href="https://tidyr.tidyverse.org/"></a></p>
<div class="inline-figure"><img src="images/tidyr.png" width="100%" class="external"></div>

</aside><p>with the <code>tidyr</code> package.</p>
<blockquote>
<p><strong>Note</strong>: I do not go over data is better in another format in this course.
Examples for this might involve matrices to benefit from matrix math or
their multidimensional equivalent: arrays.</p>
</blockquote>
<p>Let’s make some data tidy!</p>
</div>
<div id="pivot_wider" class="section level3" number="3.1.3">
<h3>
<span class="header-section-number">3.1.3</span> <code>pivot_wider</code><a class="anchor" aria-label="anchor" href="#pivot_wider"><i class="fas fa-link"></i></a>
</h3>
<p>Starting with table2, which wants to be wider.
Accordingly, we use the function <code>pivot_wider</code>.
It is very powerful, but the two most
important arguments (well, after the data) are
which column contains the names of the new columns
and which column contains the values of
the newly created columns as shown below.</p>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">table2</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">type</span>, values_from <span class="op">=</span> <span class="va">count</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
</div>
<div id="separate" class="section level3" number="3.1.4">
<h3>
<span class="header-section-number">3.1.4</span> <code>separate</code><a class="anchor" aria-label="anchor" href="#separate"><i class="fas fa-link"></i></a>
</h3>
<p>To make table3 tidy, we need the <code>separate</code> function,
followed by mutate to get the new columns into
the correct datatype.
Run it yourself step by step to see why the mutate
afterwards is necessary.</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">table3</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span><span class="va">rate</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cases"</span>, <span class="st">"population"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>cases <span class="op">=</span> <span class="fu">parse_number</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span>,
         population <span class="op">=</span> <span class="fu">parse_number</span><span class="op">(</span><span class="va">population</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>The <code>parse_</code> functions come from <code>readr</code>.
Parsing is the act of turning raw text into usable data,
and the <code>parse_number</code> function does a particularly good
job at extracting numbers, where the naïve approach of
<code>as.numeric</code> might fail e.g.</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">some_text</span> <span class="op">=</span> <span class="st">"take my number: 12"</span>
<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">some_text</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">parse_number</span><span class="op">(</span><span class="va">some_text</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
</div>
<div id="left_join" class="section level3" number="3.1.5">
<h3>
<span class="header-section-number">3.1.5</span> <code>left_join</code><a class="anchor" aria-label="anchor" href="#left_join"><i class="fas fa-link"></i></a>
</h3>
<p>Now is the time to join <code>table4a</code> and <code>tabl4b</code> together.
For this, we need an operation known from databases
as a <code>join</code>.
In fact, this whole concept of
tidy data is closely related to databases and
something called Codd`s normal forms<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;E. F. Codd, &lt;em&gt;The Relational Model for Database Management: Version 2&lt;/em&gt; (&lt;span&gt;USA&lt;/span&gt;: &lt;span&gt;Addison-Wesley Longman Publishing Co., Inc.&lt;/span&gt;, 1990); Hadley Wickham, &lt;span&gt;“Tidy &lt;span&gt;Data&lt;/span&gt;,”&lt;/span&gt; &lt;em&gt;Journal of Statistical Software&lt;/em&gt; 59, no. 1 (September 2014): 1–23, &lt;a href="https://doi.org/10.18637/jss.v059.i10" role="doc-biblioref"&gt;https://doi.org/10.18637/jss.v059.i10&lt;/a&gt;.&lt;/p&gt;'><sup>28</sup></a></span> so I am throwing these
references in here just in case you are interested in
the theoretical foundations.
But without further ado:</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the suffix argument is necessary because the columns</span>
<span class="co"># in the two tables have the same names</span>
<span class="va">table4</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">table4a</span>, <span class="va">table4b</span>, by <span class="op">=</span> <span class="st">"country"</span>,
                    suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"_cases"</span>, <span class="st">"_population"</span><span class="op">)</span><span class="op">)</span>
<span class="va">table4</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   country     `1999_cases` `2000_cases` `1999_population` `2000_population`
##   &lt;chr&gt;              &lt;int&gt;        &lt;int&gt;             &lt;int&gt;             &lt;int&gt;
## 1 Afghanistan          745         2666          19987071          20595360
## 2 Brazil             37737        80488         172006362         174504898
## 3 China             212258       213766        1272915272        1280428583</code></pre>
</div>
<div id="pivot_longer" class="section level3" number="3.1.6">
<h3>
<span class="header-section-number">3.1.6</span> <code>pivot_longer</code><a class="anchor" aria-label="anchor" href="#pivot_longer"><i class="fas fa-link"></i></a>
</h3>
<p>Now we can deal with the next problem:
Making the table longer so that
year, population and cases become their own
columns again, because they are independent features.
Consequently, we use the function <code>pivot_longer</code>:</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># note that cols takes what is called a tidyselect specification.</span>
<span class="co"># you know this from the selection function and it's help page.</span>
<span class="co"># here, I am selecting everything BUT the country column.</span>
<span class="va">long_table4</span> <span class="op">&lt;-</span> <span class="va">table4</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">country</span><span class="op">)</span>
<span class="va">long_table4</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
##    country     name                 value
##    &lt;chr&gt;       &lt;chr&gt;                &lt;int&gt;
##  1 Afghanistan 1999_cases             745
##  2 Afghanistan 2000_cases            2666
##  3 Afghanistan 1999_population   19987071
##  4 Afghanistan 2000_population   20595360
##  5 Brazil      1999_cases           37737
##  6 Brazil      2000_cases           80488
##  7 Brazil      1999_population  172006362
##  8 Brazil      2000_population  174504898
##  9 China       1999_cases          212258
## 10 China       2000_cases          213766
## 11 China       1999_population 1272915272
## 12 China       2000_population 1280428583</code></pre>
<p>But we are not done yet, table4 is putting all our skills
to the test.
There is a way to do the following steps with
<code>pivot_wider</code> straight away, but doing it step by
step should be easier to follow.
You can revisit this part and check out the
other arguments to <code>pivot_wider</code> if you fancy a challenge.
The next step we already know: separating
a column into two.
Only the separator changed.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long_table4_separated</span> <span class="op">&lt;-</span> <span class="va">long_table4</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span>col <span class="op">=</span> <span class="va">name</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"type"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>
<span class="va">long_table4_separated</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    country     year  type            value
##    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;           &lt;int&gt;
##  1 Afghanistan 1999  cases             745
##  2 Afghanistan 2000  cases            2666
##  3 Afghanistan 1999  population   19987071
##  4 Afghanistan 2000  population   20595360
##  5 Brazil      1999  cases           37737
##  6 Brazil      2000  cases           80488
##  7 Brazil      1999  population  172006362
##  8 Brazil      2000  population  174504898
##  9 China       1999  cases          212258
## 10 China       2000  cases          213766
## 11 China       1999  population 1272915272
## 12 China       2000  population 1280428583</code></pre>
<p>Now we are back to the problem we had in table2,
so we know how to make this table wider again:</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long_table4_separated</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">type</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country     year   cases population
##   &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan 1999     745   19987071
## 2 Afghanistan 2000    2666   20595360
## 3 Brazil      1999   37737  172006362
## 4 Brazil      2000   80488  174504898
## 5 China       1999  212258 1272915272
## 6 China       2000  213766 1280428583</code></pre>
<p>We did it!
Now one last look at <code>table5</code>, which contains a case
we haven’t encountered yet: a feature is separated
across two columns, so we need the opposite of
<code>separeate</code>: <code>unite</code>.</p>
</div>
<div id="unite" class="section level3" number="3.1.7">
<h3>
<span class="header-section-number">3.1.7</span> <code>unite</code><a class="anchor" aria-label="anchor" href="#unite"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">table5</span> <span class="op">%&gt;%</span> 
  <span class="fu">unite</span><span class="op">(</span>col <span class="op">=</span> <span class="va">year</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">century</span>, <span class="va">year</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">parse_number</span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country      year rate             
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
## 1 Afghanistan  1999 745/19987071     
## 2 Afghanistan  2000 2666/20595360    
## 3 Brazil       1999 37737/172006362  
## 4 Brazil       2000 80488/174504898  
## 5 China        1999 212258/1272915272
## 6 China        2000 213766/1280428583</code></pre>
</div>
<div id="another-example" class="section level3" number="3.1.8">
<h3>
<span class="header-section-number">3.1.8</span> Another Example<a class="anchor" aria-label="anchor" href="#another-example"><i class="fas fa-link"></i></a>
</h3>
<p>Let us look at one last example of data that needs tidying,
which is also provided by the <code>tidyr</code> package as an example:</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">billboard</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">paged_table</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["artist"],"name":[1],"type":["chr"],"align":["left"]},{"label":["track"],"name":[2],"type":["chr"],"align":["left"]},{"label":["date.entered"],"name":[3],"type":["date"],"align":["right"]},{"label":["wk1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["wk2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["wk3"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wk4"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["wk5"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["wk6"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["wk7"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["wk8"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["wk9"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["wk10"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["wk11"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["wk12"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["wk13"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["wk14"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["wk15"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["wk16"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["wk17"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["wk18"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["wk19"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["wk20"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["wk21"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["wk22"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["wk23"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["wk24"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["wk25"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["wk26"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["wk27"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["wk28"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["wk29"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["wk30"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["wk31"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["wk32"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["wk33"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["wk34"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["wk35"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["wk36"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["wk37"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["wk38"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["wk39"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["wk40"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["wk41"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["wk42"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["wk43"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["wk44"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["wk45"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["wk46"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["wk47"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["wk48"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["wk49"],"name":[52],"type":["dbl"],"align":["right"]},{"label":["wk50"],"name":[53],"type":["dbl"],"align":["right"]},{"label":["wk51"],"name":[54],"type":["dbl"],"align":["right"]},{"label":["wk52"],"name":[55],"type":["dbl"],"align":["right"]},{"label":["wk53"],"name":[56],"type":["dbl"],"align":["right"]},{"label":["wk54"],"name":[57],"type":["dbl"],"align":["right"]},{"label":["wk55"],"name":[58],"type":["dbl"],"align":["right"]},{"label":["wk56"],"name":[59],"type":["dbl"],"align":["right"]},{"label":["wk57"],"name":[60],"type":["dbl"],"align":["right"]},{"label":["wk58"],"name":[61],"type":["dbl"],"align":["right"]},{"label":["wk59"],"name":[62],"type":["dbl"],"align":["right"]},{"label":["wk60"],"name":[63],"type":["dbl"],"align":["right"]},{"label":["wk61"],"name":[64],"type":["dbl"],"align":["right"]},{"label":["wk62"],"name":[65],"type":["dbl"],"align":["right"]},{"label":["wk63"],"name":[66],"type":["dbl"],"align":["right"]},{"label":["wk64"],"name":[67],"type":["dbl"],"align":["right"]},{"label":["wk65"],"name":[68],"type":["dbl"],"align":["right"]},{"label":["wk66"],"name":[69],"type":["lgl"],"align":["right"]},{"label":["wk67"],"name":[70],"type":["lgl"],"align":["right"]},{"label":["wk68"],"name":[71],"type":["lgl"],"align":["right"]},{"label":["wk69"],"name":[72],"type":["lgl"],"align":["right"]},{"label":["wk70"],"name":[73],"type":["lgl"],"align":["right"]},{"label":["wk71"],"name":[74],"type":["lgl"],"align":["right"]},{"label":["wk72"],"name":[75],"type":["lgl"],"align":["right"]},{"label":["wk73"],"name":[76],"type":["lgl"],"align":["right"]},{"label":["wk74"],"name":[77],"type":["lgl"],"align":["right"]},{"label":["wk75"],"name":[78],"type":["lgl"],"align":["right"]},{"label":["wk76"],"name":[79],"type":["lgl"],"align":["right"]}],"data":[{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"2000-02-26","4":"87","5":"82","6":"72","7":"77","8":"87","9":"94","10":"99","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA","16":"NA","17":"NA","18":"NA","19":"NA","20":"NA","21":"NA","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"2Ge+her","2":"The Hardest Part Of ...","3":"2000-09-02","4":"91","5":"87","6":"92","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"NA","15":"NA","16":"NA","17":"NA","18":"NA","19":"NA","20":"NA","21":"NA","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"3 Doors Down","2":"Kryptonite","3":"2000-04-08","4":"81","5":"70","6":"68","7":"67","8":"66","9":"57","10":"54","11":"53","12":"51","13":"51","14":"51","15":"51","16":"47","17":"44","18":"38","19":"28","20":"22","21":"18","22":"18","23":"14","24":"12","25":"7","26":"6","27":"6","28":"6","29":"5","30":"5","31":"4","32":"4","33":"4","34":"4","35":"3","36":"3","37":"3","38":"4","39":"5","40":"5","41":"9","42":"9","43":"15","44":"14","45":"13","46":"14","47":"16","48":"17","49":"21","50":"22","51":"24","52":"28","53":"33","54":"42","55":"42","56":"49","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"3 Doors Down","2":"Loser","3":"2000-10-21","4":"76","5":"76","6":"72","7":"69","8":"67","9":"65","10":"55","11":"59","12":"62","13":"61","14":"61","15":"59","16":"61","17":"66","18":"72","19":"76","20":"75","21":"67","22":"73","23":"70","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"504 Boyz","2":"Wobble Wobble","3":"2000-04-15","4":"57","5":"34","6":"25","7":"17","8":"17","9":"31","10":"36","11":"49","12":"53","13":"57","14":"64","15":"70","16":"75","17":"76","18":"78","19":"85","20":"92","21":"96","22":"NA","23":"NA","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"},{"1":"98^0","2":"Give Me Just One Nig...","3":"2000-08-19","4":"51","5":"39","6":"34","7":"26","8":"26","9":"19","10":"2","11":"2","12":"3","13":"6","14":"7","15":"22","16":"29","17":"36","18":"47","19":"67","20":"66","21":"84","22":"93","23":"94","24":"NA","25":"NA","26":"NA","27":"NA","28":"NA","29":"NA","30":"NA","31":"NA","32":"NA","33":"NA","34":"NA","35":"NA","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"NA","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"NA","70":"NA","71":"NA","72":"NA","73":"NA","74":"NA","75":"NA","76":"NA","77":"NA","78":"NA","79":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>This is a lot of columns!
For 76 weeks after a song entered the top 100 (I assume in the USA)
it’s position is recorded.
It might be in this format because it made data entry easier,
or the previous person wanted to make plots in excel,
where this wide format is used to denote multiple traces.
In any event, for our style of visualizations with the grammar of
graphics, we want a column to represent a feature,
so this data needs to get longer:</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long_billboard</span> <span class="op">&lt;-</span> <span class="va">billboard</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"w"</span><span class="op">)</span>,
               names_to <span class="op">=</span> <span class="st">"week"</span>,
               names_pattern <span class="op">=</span> <span class="st">"wk(\\d+)"</span>,
               values_to <span class="op">=</span> <span class="st">"placement"</span>,
               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>week <span class="op">=</span> <span class="fu">parse_integer</span><span class="op">(</span><span class="va">week</span><span class="op">)</span>,
         date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">date.entered</span><span class="op">)</span> <span class="op">+</span> <span class="fl">7</span> <span class="op">*</span> <span class="op">(</span><span class="va">week</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">date.entered</span><span class="op">)</span>

<span class="va">long_billboard</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">paged_table</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["artist"],"name":[1],"type":["chr"],"align":["left"]},{"label":["track"],"name":[2],"type":["chr"],"align":["left"]},{"label":["week"],"name":[3],"type":["int"],"align":["right"]},{"label":["placement"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["date"],"name":[5],"type":["date"],"align":["right"]}],"data":[{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"1","4":"87","5":"2000-02-26"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"2","4":"82","5":"2000-03-04"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"3","4":"72","5":"2000-03-11"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"4","4":"77","5":"2000-03-18"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"5","4":"87","5":"2000-03-25"},{"1":"2 Pac","2":"Baby Don't Cry (Keep...","3":"6","4":"94","5":"2000-04-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<blockquote>
<p>This time I am leaving the visualisation up to you.
This is a greate opportunity to play around with ggplot!</p>
</blockquote>
<p>This whole tidy data idea might seem like just another
way of moving numbers around.
But once you build the mental model for it,
it will truly transform the way you are able to think about data.
Both for data wrangling with dplyr, as shown last
week, and also for data visualization with ggplot,
a journey we began in the first week and that is
still well underway.</p>
</div>
</div>
<div id="more-shapes-for-data" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> More Shapes for Data<a class="anchor" aria-label="anchor" href="#more-shapes-for-data"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>tidyr</code> package provides more tools for dealing
with data in various shapes.
We just discovered the first set of operations called <em>pivoting</em>
to get a feel for tidy data and to obtain
it from various formats.
But data is not always rectangular
like we can show it in a spreadsheet.
Sometimes data already comes in a nested
form, sometimes we create nested data because it serves
our purpose (see next week).
So, what do I mean by nested?</p>
<div id="nested-data" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Nested Data<a class="anchor" aria-label="anchor" href="#nested-data"><i class="fas fa-link"></i></a>
</h3>
<p>Remember that <code>lists</code> can contain elements
of any type, even other lists?
Well, if have have a list that contains
more lists, we call it nested. E.g.</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fl">42</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"hi"</span>, <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1 2
## 
## [[2]]
## [[2]][[1]]
## [1] 42
## 
## [[2]][[2]]
## [[2]][[2]][[1]]
## [1] "hi"
## 
## [[2]][[2]][[2]]
## [1] TRUE</code></pre>
<p>But nested list are not always fun to work with,
and when there is a straightforward way to represent
the same data in a rectangular, flat format,
we most likely want to do that.
We will deal with data rectangling today was well.
But first, there is another implication
of nested lists:
Because dataframes (and tibbles) are built on top
of lists, we can nest them to!
This can sometimes come in really handy.
We a dataframe contains a column that is not
an atomic vector but a list (so it is a list in a list),
we call it a list column:</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"hello"</span>, <span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">example</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##       x y        
##   &lt;int&gt; &lt;list&gt;   
## 1     1 &lt;chr [1]&gt;
## 2     2 &lt;lgl [1]&gt;
## 3     3 &lt;dbl [4]&gt;</code></pre>
<p>Here, the output in our code only tells us,
that the list column y contains an
atomic character vector of length 1,
a logical vector of length 1 and
a double vector of length 4.
The overall length of the column is 3,
because it has to fit in the tibble.</p>
<p>We can get a better view of what is in there
by either pulling the column out with
the subsetting functions we already learned
(like <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code>, <code>[[]]</code>, <code>pull</code>), using
<code>str</code> to learn more about the structure
or simply using RStudio’s <strong>Environment</strong> panel
to inspect our variable.
Click on the name to view it in a new window
(the same can be done from code by using
the function <code>View</code> or Ctrl+Clicking the variable name)
or use the little blue arrow to expand the list.</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">include_graphics</span><span class="op">(</span><span class="st">"images/environment.png"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/environment.png" width="100%"></div>
<p>This extends even further,
we are about to go full inception on this!
A list column can contain tibbles (/dataframes)
as well!</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nested_tibble</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,
  df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, y <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,
    <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span>, <span class="fl">3</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">nested_tibble</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##      id df               
##   &lt;int&gt; &lt;list&gt;           
## 1     1 &lt;tibble [10 × 2]&gt;
## 2     2 &lt;tibble [34 × 2]&gt;</code></pre>
<p>We can still use the data nested in there,
as long as we remember how to chain
our subsetting functions together.</p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># take the column df, take the second element</span>
<span class="va">nested_tibble</span><span class="op">$</span><span class="va">df</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## # A tibble: 34 x 2
##        x     y
##    &lt;dbl&gt; &lt;dbl&gt;
##  1     1  1   
##  2     4  2   
##  3     7  2.65
##  4    10  3.16
##  5    13  3.61
##  6    16  4   
##  7    19  4.36
##  8    22  4.69
##  9    25  5   
## 10    28  5.29
## # … with 24 more rows</code></pre>
<p>A handy way to subsett into nested structures
is with the <code>pluck</code> function:</p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nested_tibble</span> <span class="op">%&gt;%</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"df"</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 34 x 2
##        x     y
##    &lt;dbl&gt; &lt;dbl&gt;
##  1     1  1   
##  2     4  2   
##  3     7  2.65
##  4    10  3.16
##  5    13  3.61
##  6    16  4   
##  7    19  4.36
##  8    22  4.69
##  9    25  5   
## 10    28  5.29
## # … with 24 more rows</code></pre>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nested_tibble</span><span class="op">$</span><span class="va">df</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="dataintro_files/figure-html/unnamed-chunk-143-1.png" width="100%"></div>
<p>This will be incredibly useful next week,
when we talk about <strong>iteration</strong>.</p>
<p>Creating a tibble by hand is unlikely
going to be the way that you end up
with a nested tibble.
Let’s create one from an already existing tibble.
We can use the long version of the
billboard dataset we created above.</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nested_billboard</span> <span class="op">&lt;-</span> <span class="va">long_billboard</span> <span class="op">%&gt;%</span> 
  <span class="fu">nest</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">artist</span>, <span class="op">-</span><span class="va">track</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nested_billboard</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   artist       track                   data             
##   &lt;chr&gt;        &lt;chr&gt;                   &lt;list&gt;           
## 1 2 Pac        Baby Don't Cry (Keep... &lt;tibble [7 × 3]&gt; 
## 2 2Ge+her      The Hardest Part Of ... &lt;tibble [3 × 3]&gt; 
## 3 3 Doors Down Kryptonite              &lt;tibble [53 × 3]&gt;
## 4 3 Doors Down Loser                   &lt;tibble [20 × 3]&gt;
## 5 504 Boyz     Wobble Wobble           &lt;tibble [18 × 3]&gt;
## 6 98^0         Give Me Just One Nig... &lt;tibble [20 × 3]&gt;</code></pre>
<p>Notice, how similar this is to <code>group_by</code>,
except it is much more explicit.
The resulting groups are now separated
into their own tibble in the
list column I named <em>data</em>.
Again, RStudio’s environment panel
makes it easier to inspect the data.</p>
<p>We can get back to our original shape
by <strong>unnesting</strong> the tibble</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nested_billboard</span> <span class="op">%&gt;%</span> 
  <span class="fu">unnest</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   artist track                    week placement date      
##   &lt;chr&gt;  &lt;chr&gt;                   &lt;int&gt;     &lt;dbl&gt; &lt;date&gt;    
## 1 2 Pac  Baby Don't Cry (Keep...     1        87 2000-02-26
## 2 2 Pac  Baby Don't Cry (Keep...     2        82 2000-03-04
## 3 2 Pac  Baby Don't Cry (Keep...     3        72 2000-03-11
## 4 2 Pac  Baby Don't Cry (Keep...     4        77 2000-03-18
## 5 2 Pac  Baby Don't Cry (Keep...     5        87 2000-03-25
## 6 2 Pac  Baby Don't Cry (Keep...     6        94 2000-04-01</code></pre>
<p>Unnesting is one special case for the
general idea of data rectangling, for
which the <code>tidyr</code> package provides more functions.
Unfortunately, we can’t all explore them all today.</p>
</div>
</div>
<div id="a-sneak-peak-at-iteration" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> A Sneak Peak at Iteration<a class="anchor" aria-label="anchor" href="#a-sneak-peak-at-iteration"><i class="fas fa-link"></i></a>
</h2>
<p>Next week we are going to explore
the concept of iteration, having R do one
operation for multiple things.
But today, I am already giving you a
sneak peak at how nested data can help
us in that respect.
It will also make sure you get more
comfortable with writing functions.</p>
<p>Let us take just one dataset out of
the many datasets:</p>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">one_track</span> <span class="op">&lt;-</span> <span class="va">nested_billboard</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">one_track</span></code></pre></div>
<pre><code>## # A tibble: 7 x 3
##    week placement date      
##   &lt;int&gt;     &lt;dbl&gt; &lt;date&gt;    
## 1     1        87 2000-02-26
## 2     2        82 2000-03-04
## 3     3        72 2000-03-11
## 4     4        77 2000-03-18
## 5     5        87 2000-03-25
## 6     6        94 2000-04-01
## 7     7        99 2000-04-08</code></pre>
<p>This contains the performance of one song.
we can create a plot of it:</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">one_track</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">week</span>, <span class="va">placement</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="dataintro_files/figure-html/unnamed-chunk-147-1.png" width="100%"></div>
<p>Moreover, we can create a function,
that takes some data and creates
a plot from it:</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_song_performance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">song_data</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="va">song_data</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">week</span>, <span class="va">placement</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We can now pass any song data from the
nested dataframe to it:</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plot_song_performance</span><span class="op">(</span><span class="va">nested_billboard</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="dataintro_files/figure-html/unnamed-chunk-149-1.png" width="100%"></div>
<p>But we are more ambitious, we want this
plot for all songs!
The <code>map</code> function from the <code>purrr</code> package
takes a list and a function and
applies the function to all elements of the
list. It is really powerful (and fun).
We will learn all about it next week,
but here is a preview:</p>
<aside><a href="https://purrr.tidyverse.org/">
<img src="images/purrr.png"></a>
</aside><div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">song_performance</span> <span class="op">&lt;-</span> <span class="va">nested_billboard</span> <span class="op">%&gt;%</span> 
   <span class="fu">mutate</span><span class="op">(</span>
      plt <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="va">plot_song_performance</span><span class="op">)</span>
   <span class="op">)</span>

<span class="va">song_performance</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   artist       track                   data              plt   
##   &lt;chr&gt;        &lt;chr&gt;                   &lt;list&gt;            &lt;list&gt;
## 1 2 Pac        Baby Don't Cry (Keep... &lt;tibble [7 × 3]&gt;  &lt;gg&gt;  
## 2 2Ge+her      The Hardest Part Of ... &lt;tibble [3 × 3]&gt;  &lt;gg&gt;  
## 3 3 Doors Down Kryptonite              &lt;tibble [53 × 3]&gt; &lt;gg&gt;  
## 4 3 Doors Down Loser                   &lt;tibble [20 × 3]&gt; &lt;gg&gt;  
## 5 504 Boyz     Wobble Wobble           &lt;tibble [18 × 3]&gt; &lt;gg&gt;  
## 6 98^0         Give Me Just One Nig... &lt;tibble [20 × 3]&gt; &lt;gg&gt;</code></pre>
<p>And now we can look at individual plots:</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">song_performance</span><span class="op">$</span><span class="va">plt</span><span class="op">[[</span><span class="fl">24</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="inline-figure"><img src="dataintro_files/figure-html/unnamed-chunk-151-1.png" width="100%"></div>
<p>It might have been handy to include a title
for the plot, so let’s modify
our plotting function a little bit:</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_song_performance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">song_data</span>, <span class="va">title</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="va">song_data</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">week</span>, <span class="va">placement</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>And now we use the function <code>map2</code> instead of <code>map</code>,
which iterates over two vectors at the
same time to also pass the plot title:</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">song_performance</span> <span class="op">&lt;-</span> <span class="va">nested_billboard</span> <span class="op">%&gt;%</span> 
   <span class="fu">mutate</span><span class="op">(</span>
      plt <span class="op">=</span> <span class="fu">map2</span><span class="op">(</span><span class="va">data</span>, <span class="va">track</span>,  <span class="va">plot_song_performance</span><span class="op">)</span>
   <span class="op">)</span>

<span class="va">song_performance</span><span class="op">$</span><span class="va">plt</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="inline-figure"><img src="dataintro_files/figure-html/unnamed-chunk-153-1.png" width="100%"></div>
<p>When we don’t care about the return value
of a function, but rather about the side-effect
it has, we use the <code>walk</code> function in place of <code>map</code>.
A side-effect is anything that changes the state
of your program or the world around it,
as opposed to pure functions, which only depend
on their arguments return some value.
Writing to a file for example is a side effect:</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="st">"plts"</span><span class="op">)</span>

<span class="va">save_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">name</span>, <span class="va">plot</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">ggsave</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"plts/"</span>, <span class="va">name</span>, <span class="st">".png"</span><span class="op">)</span>, <span class="va">plot</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">walk2</span><span class="op">(</span><span class="va">song_performance</span><span class="op">$</span><span class="va">track</span>, <span class="va">song_performance</span><span class="op">$</span><span class="va">plt</span>, <span class="va">save_plot</span><span class="op">)</span></code></pre></div>
<p>Do try this at home, it feels quite good
to achieve so much with one key-press!</p>
</div>
<div id="exercises-2" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-2"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="tidy-data-2" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Tidy Data<a class="anchor" aria-label="anchor" href="#tidy-data-2"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Imagine for a second this whole pandemic thing is not
going on and we are planning a vacation.
Of course, we want to choose the safest airline possible,
so we download data about incident reports.
You can find it in the <em>data</em> folder<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;source: &lt;a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2018/2018-08-07"&gt;tidytuesday&lt;/a&gt;&lt;/p&gt;'><sup>29</sup></a>.</li>
<li>Instead of the <code>type_of_event</code> and <code>n_events</code> columns
we would like to have one column per type of event,
where the values are the count for this event.</li>
<li>Which airlines had the least fatal accidents,
standardized to the distance theses airlines covered,
in the two time ranges?</li>
<li>Even if something where to go wrong, which airlines
have the best record when it comes to fatalities per fatal accident?</li>
<li>Create an informative plot to highlight your
discoveries. It might be beneficial to only
plot e.g. the highest or lowest scoring Airlines.
One of the <code>slice_</code> functions will help you there.
And to make your plot prettier, you will
have to look into <code>fct_reorder</code> again.</li>
</ol>
</div>
<div id="functions-and-iteration" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Functions and Iteration<a class="anchor" aria-label="anchor" href="#functions-and-iteration"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>You are going strong so far! Programming can sometimes
to motivate us. R is up to the task.
be frustrating, so I think what we need is someone
Write a function that takes a name, like “Jannik” or
your name, and spits out a motivational message that
includes the name.
Make sure to also test it and show that it works.</li>
<li>Now that you have a motivational machine,
you need to make sure to motivate the greatest
amount of people.
Use the <code>map</code> function to apply your function
to a whole vector of names.</li>
</ol>
</div>
<div id="resources-1" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> Resources<a class="anchor" aria-label="anchor" href="#resources-1"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><a href="https://tidyr.tidyverse.org/">tidyr documentation</a></li>
<li><a href="https://purrr.tidyverse.org/">purrr documentation</a></li>
<li>
<a href="https://stringr.tidyverse.org/">stringr documentation</a>
for working with text and a helpful cheatsheet for
the <strong>regular expressions</strong> mentioned in the video</li>
</ul>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="data-wrangling.html"><span class="header-section-number">2</span> Data Wrangling</a></div>
<div class="next"><a href="functions-1.html"><span class="header-section-number">4</span> Functions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#tidy-data"><span class="header-section-number">3</span> Tidy Data</a></li>
<li>
<a class="nav-link" href="#tidy-data-1"><span class="header-section-number">3.1</span> Tidy data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#what-and-why-is-tidy-data"><span class="header-section-number">3.1.1</span> What and Why is Tidy Data?</a></li>
<li><a class="nav-link" href="#making-data-tidy"><span class="header-section-number">3.1.2</span> Making Data Tidy</a></li>
<li><a class="nav-link" href="#pivot_wider"><span class="header-section-number">3.1.3</span> pivot_wider</a></li>
<li><a class="nav-link" href="#separate"><span class="header-section-number">3.1.4</span> separate</a></li>
<li><a class="nav-link" href="#left_join"><span class="header-section-number">3.1.5</span> left_join</a></li>
<li><a class="nav-link" href="#pivot_longer"><span class="header-section-number">3.1.6</span> pivot_longer</a></li>
<li><a class="nav-link" href="#unite"><span class="header-section-number">3.1.7</span> unite</a></li>
<li><a class="nav-link" href="#another-example"><span class="header-section-number">3.1.8</span> Another Example</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#more-shapes-for-data"><span class="header-section-number">3.2</span> More Shapes for Data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#nested-data"><span class="header-section-number">3.2.1</span> Nested Data</a></li></ul>
</li>
<li><a class="nav-link" href="#a-sneak-peak-at-iteration"><span class="header-section-number">3.3</span> A Sneak Peak at Iteration</a></li>
<li><a class="nav-link" href="#exercises-2"><span class="header-section-number">3.4</span> Exercises</a></li>
<li><a class="nav-link" href="#tidy-data-2"><span class="header-section-number">3.5</span> Tidy Data</a></li>
<li><a class="nav-link" href="#functions-and-iteration"><span class="header-section-number">3.6</span> Functions and Iteration</a></li>
<li><a class="nav-link" href="#resources-1"><span class="header-section-number">3.7</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jmbuhr/dataintro/blob/master/03-tidy.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jmbuhr/dataintro/edit/master/03-tidy.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Data Analysis with R</strong>" was written by Jannik Buhr. It was last built on 2021-08-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
